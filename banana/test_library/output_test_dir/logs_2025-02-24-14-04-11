Config: INFO > Loading configuration from configs/run_model_1.yml
IO: SUCCESS > Working directory has been set to ./output_test_dir and logger has started logging (with verbosity 2)
Config: INFO > Optional section analyses is not found in configuration
Config: INFO > Optional section utils is not found in configuration
Config: WARNING > {'example': {'path': './data/observations_CF4gp.txt', 'filters': {'cut_type_0_redshift': [['type', 0], ['z_tot', 0.01, 0.05]], 'cut_type_1_redshift': [['type', 1], ['z_tot', 0.01, 0.04]], 'cut_type_2_redshift': [['type', 2], ['z_tot', 0.01, 0.03]]}}}
Config: INFO > Saving data in the working dir
IO: INFO > Saving data z_tot in ./output_test_dir/data/z_tot.npy
IO: WARNING > ./output_test_dir/data/z_tot.npy exists, overwriting it
IO: INFO > Saving data err_z_tot in ./output_test_dir/data/err_z_tot.npy
IO: WARNING > ./output_test_dir/data/err_z_tot.npy exists, overwriting it
IO: INFO > Saving data dist_mod in ./output_test_dir/data/dist_mod.npy
IO: WARNING > ./output_test_dir/data/dist_mod.npy exists, overwriting it
IO: INFO > Saving data err_dist_mod in ./output_test_dir/data/err_dist_mod.npy
IO: WARNING > ./output_test_dir/data/err_dist_mod.npy exists, overwriting it
IO: INFO > Saving data type in ./output_test_dir/data/type.npy
IO: WARNING > ./output_test_dir/data/type.npy exists, overwriting it
IO: INFO > Saving data direction in ./output_test_dir/data/direction.npy
IO: WARNING > ./output_test_dir/data/direction.npy exists, overwriting it
IO: INFO > Saving data example_mask in ./output_test_dir/data/example_mask.npy
IO: WARNING > ./output_test_dir/data/example_mask.npy exists, overwriting it
Config: INFO > Saving configuration in ./output_test_dir/config.yml
Core: INFO > Run described as: 
             ######################################
             ### This is a test model of banana ###
             ######################################
Core: WARNING > #############
                No GPU Found!
                #############
                
Core: INFO > Setting and loading libraries
Core: INFO > Applying config to modules
Core: INFO > Applying config to variables
Core: INFO > Applying config to analyses
Core: INFO > Applying config to utils
Core: INFO > Selected modules:
             
              Name                                     | Requires                                           | Provides                       | Library
             -----------------------------------------------------------------------------------------------------------------------------------------
              LikelihoodDistanceModuli                 | dist_mod                                           | log_prob                       | ./modules.py
              LikelihoodRedshifts                      | z_tot                                              | log_prob                       | ./modules.py
              PriorDistances                           | distances                                          | log_prob                       | ./modules.py
              PriorVelocities                          | v_r                                                | log_prob                       | ./modules.py
             
Core: INFO > Selected variables:
             
              Name                                     | Provides                                           | Library
             --------------------------------------------------------------------------------------------------------
              Distances                                | distances                                          | ./variables.py
              Velocities                               | v_r                                                | ./variables.py
             
Core: SUCCESS > Loaded libraries
Core: INFO > Building tree
Core: SUCCESS > Tree built
Core: INFO > The tree is 
             
             NODES:
             variables       | Distances | Velocities
             Layer 2         | CosmologicalRedshifts
             Layer 1         | DistanceModuli | Redshift
             Layer 0         | LikelihoodDistanceModuli | LikelihoodRedshifts | PriorDistances | PriorVelocities
             
             LINKS:
             LikelihoodDistanceModuli                                     <- DistanceModuli                          
             LikelihoodRedshifts                                          <- Redshift                                
             PriorDistances                                               <- Distances                               
             PriorVelocities                                              <- Velocities                              
             DistanceModuli                                               <- CosmologicalRedshifts                   
             DistanceModuli                                               <- Distances                               
             Redshift                                                     <- CosmologicalRedshifts                   
             Redshift                                                     <- Velocities                              
             CosmologicalRedshifts                                        <- Distances                               
             
Core: INFO > Parameters are {
                 'sigma_v': 300
                 'cosmology': {
                     'h0': 0.746
                     'Omega_m': 0.3
                 }
             }
             
Core: INFO > Data are
                                                       min            max           mean            std               shape
             z_tot                                 0.01041        0.04935        0.02269        0.00847                 817
             err_z_tot                             0.00016        0.00016        0.00016        0.00000                 817
             dist_mod                             32.41000       36.91000       34.68616        0.85236                 817
             err_dist_mod                          0.04000        0.84000        0.41067        0.11373                 817
             type                                  0.00000        1.00000        0.15422        0.36116                 817
             direction[0]                         -0.79950        0.98238        0.41089        0.39290                 817
             direction[1]                         -0.99968        0.35253       -0.77606        0.20799                 817
             direction[2]                         -0.35083        0.34021        0.01287        0.17635                 817
             example_mask                          0.00000        1.00000        0.82442        0.38046                 991
             
Core: SUCCESS > Instanciated Distances smoothly
Core: SUCCESS > Instanciated Velocities smoothly
Core: SUCCESS > Instanciated CosmologicalRedshifts smoothly
Core: SUCCESS > Instanciated DistanceModuli smoothly
Core: SUCCESS > Instanciated Redshift smoothly
Core: SUCCESS > Instanciated LikelihoodDistanceModuli smoothly
Core: SUCCESS > Instanciated LikelihoodRedshifts smoothly
Core: SUCCESS > Instanciated PriorDistances smoothly
Core: SUCCESS > Instanciated PriorVelocities smoothly
Core: SUCCESS > Instanciated all classes, got some extra definitions to do now
Core: INFO > Signature of the log_prob function: log_prob(distances, v_r)
Core: INFO > Details about state size 
             Name                                               | Provides                                           | Size
             Distances                                          | distances                                          | 817
             Velocities                                         | v_r                                                | 817
             State size (total)                                                                                      | 1634 (0.0124664306640625 MB)
Core:runStrategy: INFO > Running command generateInitialState
Core:runStrategy: SUCCESS > Succesfully ran command generateInitialState
Core:runStrategy: INFO > Running command runDebug
Core:runStrategy: SUCCESS > Succesfully ran command runDebug
Core:runStrategy: INFO > Running command runKernel
Core:runKernel: INFO > Running KernelDualAveragingNUTS with kwargs
                       {
                           'dual_avg_kwargs': {
                               'num_adaptation_steps': 80
                           }
                           'nuts_kwargs': {
                               'max_tree_depth': 8
                           }
                       }
                       
                       and sample kwargs
                       {
                           'num_results': 100
                           'num_burnin_steps': 0
                           'num_steps_between_results': 1
                           'return_final_kernel_results': True
                           'seed': [         0 3307251305]
                       }
                       
Core:runKernel: INFO > Memory used by chain (alone): 1.24664306640625 MB
Core:runKernel: INFO > Starting kernel run warmup at Mon Feb 24 14:04:12 2025
KernelDualAveragingNUTS: INFO > Wrapping kernel into a transition kernel
Core:runKernel: SUCCESS > Done running warmup at Mon Feb 24 14:04:14 2025 in 0h:0m:2s
Core:runStrategy: SUCCESS > Succesfully ran command runKernel
Core:runStrategy: INFO > Running command saveResults
IO: INFO > Saving data current_state_['distances'] in ./output_test_dir/results/current_state_['distances'].npy
IO: WARNING > ./output_test_dir/results/current_state_['distances'].npy exists, overwriting it
IO: INFO > Saving data current_state_['v_r'] in ./output_test_dir/results/current_state_['v_r'].npy
IO: WARNING > ./output_test_dir/results/current_state_['v_r'].npy exists, overwriting it
IO: INFO > Saving data warmup_last_kernel_results to ./output_test_dir/results/warmup_last_kernel_results.dill
IO: INFO > Saving data warmup_distances in ./output_test_dir/results/warmup_distances.npy
IO: WARNING > ./output_test_dir/results/warmup_distances.npy exists, overwriting it
IO: INFO > Saving data warmup_v_r in ./output_test_dir/results/warmup_v_r.npy
IO: WARNING > ./output_test_dir/results/warmup_v_r.npy exists, overwriting it
IO: INFO > Saving data warmup_log_prob in ./output_test_dir/results/warmup_log_prob.npy
IO: WARNING > ./output_test_dir/results/warmup_log_prob.npy exists, overwriting it
IO: INFO > Saving data warmup_is_accepted in ./output_test_dir/results/warmup_is_accepted.npy
IO: WARNING > ./output_test_dir/results/warmup_is_accepted.npy exists, overwriting it
IO: INFO > Saving data warmup_step_size in ./output_test_dir/results/warmup_step_size.npy
IO: WARNING > ./output_test_dir/results/warmup_step_size.npy exists, overwriting it
IO: INFO > Saving data warmup_leapfrogs_taken in ./output_test_dir/results/warmup_leapfrogs_taken.npy
IO: WARNING > ./output_test_dir/results/warmup_leapfrogs_taken.npy exists, overwriting it
IO: INFO > Saving data warmup_has_divergence in ./output_test_dir/results/warmup_has_divergence.npy
IO: WARNING > ./output_test_dir/results/warmup_has_divergence.npy exists, overwriting it
IO: INFO > Saving data warmup_reach_max_depth in ./output_test_dir/results/warmup_reach_max_depth.npy
IO: WARNING > ./output_test_dir/results/warmup_reach_max_depth.npy exists, overwriting it
IO: INFO > Saving data warmup_accept_ratio in ./output_test_dir/results/warmup_accept_ratio.npy
IO: WARNING > ./output_test_dir/results/warmup_accept_ratio.npy exists, overwriting it
Core:runStrategy: SUCCESS > Succesfully ran command saveResults
Core:runStrategy: INFO > Running command summarize
KernelDualAveragingNUTS: INFO > Summary of warmup
                                log_prob            : max =       125.63 | min =    -21107.58 | mean =      -158.12 | std =      2107.09 | first =    -21107.58 | last =       118.12
                                is_accepted         : rate =     100.00% | first =          1 | last =            1
                                step_size           : max =        12.66 | min =         1.00 | mean =         2.39 | std =         1.09 | first =         1.00 | last =         2.46
                                leapfrogs_taken     : max =       255.00 | min =        15.00 | mean =       250.36 | std =        32.50 | first =        15.00 | last =       255.00
                                has_divergence      : rate =       0.00% | first =          0 | last =            0
                                reach_max_depth     : rate =      24.00% | first =          0 | last =            0
                                accept_ratio        : max =         1.00 | min =         0.30 | mean =         0.94 | std =         0.08 | first =         1.00 | last =         0.94
                                
Distances: INFO > Summary of warmup:distances
                                                            min            max           mean            std               shape
                  post mean                            34.63862      164.64252       71.11163       24.98350                 817
                  post std                              2.16492        5.12805        2.91663        0.28271                 817
                  post std / prior std                  0.72164        4.14794        0.98781        0.20761                 817
                  (po_m - pr_m) / po_std               -0.20219        8.71679        1.05743        1.24781                 817
                  R Split                               0.86368        1.00004        0.98968        0.01411                 817
                  ESS                                  16.12789      100.00000       88.61765       15.68806                 817
                  ESS / sample size (%)                16.12789      100.00000       88.61765       15.68806                 817
                  
Velocities: INFO > Summary of warmup:v_r
                                                             min            max           mean            std               shape
                   post mean                         -3570.10327       38.80405     -335.22775      383.89725                 817
                   post std                            217.05324      497.32184      285.01077       27.59003                 817
                   post std / prior std                  0.72351        1.65774        0.95004        0.09197                 817
                   (po_m - pr_m) / po_std               -8.99850        0.14229       -1.17064        1.19912                 817
                   R Split                               0.85596        1.00000        0.98970        0.01412                 817
                   ESS                                  16.59196      100.00000       88.81471       15.62988                 817
                   ESS / sample size (%)                16.59196      100.00000       88.81471       15.62988                 817
                   
Core:runStrategy: SUCCESS > Succesfully ran command summarize
Core:runStrategy: INFO > Running command runTraceAnalysis
Core:analyze: INFO > Analysing trace
Core:runStrategy: SUCCESS > Succesfully ran command runTraceAnalysis
Core:runStrategy: INFO > Running command forgetChain
forgetChain: INFO > Forgetting everything about warmup: ['warmup:*', 'warmup:chain', 'warmup:trace', 'warmup:kernel_instance', 'warmup:time_kernel_run', 'warmup:n_steps']
Core:runStrategy: SUCCESS > Succesfully ran command forgetChain
Core:runStrategy: INFO > Running command runKernel
Core:runKernel: INFO > Running KernelNUTS with kwargs
                       {
                           'nuts_kwargs': {
                               'max_tree_depth': 8
                           }
                       }
                       
                       and sample kwargs
                       {
                           'num_results': 100
                           'num_burnin_steps': 0
                           'num_steps_between_results': 1
                           'return_final_kernel_results': True
                           'seed': [        0 209211200]
                       }
                       
KernelNUTS: INFO > Wrapping kernel into a transition kernel
Core:runKernel: INFO > Memory used by chain (alone): 1.24664306640625 MB
Core:runKernel: INFO > Starting kernel run main at Mon Feb 24 14:04:20 2025
Core:runKernel: INFO > Expected running time: 0h:0m:2s
Core:runKernel: INFO > Expected end time: Mon Feb 24 14:04:22 2025
KernelNUTS: INFO > Wrapping kernel into a transition kernel
Core:runKernel: SUCCESS > Done running main at Mon Feb 24 14:04:22 2025 in 0h:0m:2s
Core:runStrategy: SUCCESS > Succesfully ran command runKernel
Core:runStrategy: INFO > Running command saveResults
IO: INFO > Saving data current_state_['distances'] in ./output_test_dir/results/current_state_['distances'].npy
IO: WARNING > ./output_test_dir/results/current_state_['distances'].npy exists, overwriting it
IO: INFO > Saving data current_state_['v_r'] in ./output_test_dir/results/current_state_['v_r'].npy
IO: WARNING > ./output_test_dir/results/current_state_['v_r'].npy exists, overwriting it
IO: INFO > Saving data main_last_kernel_results to ./output_test_dir/results/main_last_kernel_results.dill
IO: INFO > Saving data main_distances in ./output_test_dir/results/main_distances.npy
IO: WARNING > ./output_test_dir/results/main_distances.npy exists, overwriting it
IO: INFO > Saving data main_v_r in ./output_test_dir/results/main_v_r.npy
IO: WARNING > ./output_test_dir/results/main_v_r.npy exists, overwriting it
IO: INFO > Saving data main_log_prob in ./output_test_dir/results/main_log_prob.npy
IO: WARNING > ./output_test_dir/results/main_log_prob.npy exists, overwriting it
IO: INFO > Saving data main_is_accepted in ./output_test_dir/results/main_is_accepted.npy
IO: WARNING > ./output_test_dir/results/main_is_accepted.npy exists, overwriting it
IO: INFO > Saving data main_step_size in ./output_test_dir/results/main_step_size.npy
IO: WARNING > ./output_test_dir/results/main_step_size.npy exists, overwriting it
IO: INFO > Saving data main_leapfrogs_taken in ./output_test_dir/results/main_leapfrogs_taken.npy
IO: WARNING > ./output_test_dir/results/main_leapfrogs_taken.npy exists, overwriting it
IO: INFO > Saving data main_has_divergence in ./output_test_dir/results/main_has_divergence.npy
IO: WARNING > ./output_test_dir/results/main_has_divergence.npy exists, overwriting it
IO: INFO > Saving data main_reach_max_depth in ./output_test_dir/results/main_reach_max_depth.npy
IO: WARNING > ./output_test_dir/results/main_reach_max_depth.npy exists, overwriting it
IO: INFO > Saving data main_accept_ratio in ./output_test_dir/results/main_accept_ratio.npy
IO: WARNING > ./output_test_dir/results/main_accept_ratio.npy exists, overwriting it
Core:runStrategy: SUCCESS > Succesfully ran command saveResults
Core:runStrategy: INFO > Running command summarize
KernelNUTS: INFO > Summary of main
                   log_prob            : max =       134.76 | min =        -5.26 | mean =        64.11 | std =        28.23 | first =       107.83 | last =        -0.30
                   is_accepted         : rate =     100.00% | first =          1 | last =            1
                   step_size           : max =         2.46 | min =         2.46 | mean =         2.46 | std =         0.00 | first =         2.46 | last =         2.46
                   leapfrogs_taken     : max =       255.00 | min =       255.00 | mean =       255.00 | std =         0.00 | first =       255.00 | last =       255.00
                   has_divergence      : rate =       0.00% | first =          0 | last =            0
                   reach_max_depth     : rate =       0.00% | first =          0 | last =            0
                   accept_ratio        : max =         1.00 | min =         0.79 | mean =         0.94 | std =         0.06 | first =         0.89 | last =         1.00
                   
Distances: INFO > Summary of main:distances
                                                            min            max           mean            std               shape
                  post mean                            34.41580      164.51392       71.15385       24.97831                 817
                  post std                              1.13214        3.93477        2.85099        0.31293                 817
                  post std / prior std                  0.69332        1.35581        0.95720        0.09740                 817
                  (po_m - pr_m) / po_std               -0.34548       26.83624        1.24228        2.18164                 817
                  R Split                               0.93518        0.99999        0.99099        0.00902                 817
                  ESS                                  32.34358      100.00000       85.04139       15.91232                 817
                  ESS / sample size (%)                32.34358      100.00000       85.04139       15.91232                 817
                  
Velocities: INFO > Summary of main:v_r
                                                             min            max           mean            std               shape
                   post mean                         -3543.37866       56.46922     -339.26788      385.91269                 817
                   post std                            114.99130      377.18100      278.57501       30.15915                 817
                   post std / prior std                  0.38330        1.25727        0.92858        0.10053                 817
                   (po_m - pr_m) / po_std              -24.14704        0.21129       -1.35347        2.09817                 817
                   R Split                               0.93742        1.00000        0.99105        0.00894                 817
                   ESS                                  29.03511      100.00000       84.47492       16.15534                 817
                   ESS / sample size (%)                29.03511      100.00000       84.47492       16.15534                 817
                   
Core:runStrategy: SUCCESS > Succesfully ran command summarize
Core:runStrategy: INFO > Running command runTraceAnalysis
Core:analyze: INFO > Analysing trace
Core:runStrategy: SUCCESS > Succesfully ran command runTraceAnalysis
Core:runStrategy: INFO > Running command runAnalysis
Core:runStrategy: SUCCESS > Succesfully ran command runAnalysis
LogServer: SUCCESS > Done logging, exciting properly!
